<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-aFq/bzH65dt+w6FI2ooMVUpc+21e0SRygnTpmBvdBgSdnuTN7QbdgL+OapgHtvPp" crossorigin="anonymous">
    <title>FurnStock</title>
</head>
<body>
    <header>
        <p>Ships to: <img src="https://img.icons8.com/external-justicon-flat-justicon/1x/external-india-flag-countrys-flags-justicon-flat-justicon.png" alt="flag">India </p>
    </header>
    <nav id="nav" class="navbar navbar-expand-lg navbar bg-primary sticky-top shadow ">
        <div class="container-fluid">
         
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <a class="navbar-brand" href="./index.html"><img id="image" src="./image/FurnStock.png" alt="FurnStock"  width="50" height="54"></a>
          <form class="d-flex" role="search" id="search"  style="border-color: blue;">
            <input class="form-control me-2" type="search" style="background-color: rgb(227, 227, 227);" placeholder="Search...everything you find ships for free" aria-label="Search">
            <button class="btn btn-outline-danger" style="background-color: red;color: white;" type="submit">Search</button>
          </form>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
          
            <ul class="navbar-nav ms-auto">
              <li class="nav-item">
                <a class="nav-link" aria-current="page" href="./registration.html"><img src="https://img.icons8.com/ios/1x/user.png" alt="person" height="24"></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="./"><img src="https://img.icons8.com/ios/256/hearts--v1.png" alt="wish" height="24"></a>
              </li>
             
              <li class="nav-item">
                <a class="nav-link" href="./cart.html"><img src="https://img.icons8.com/fluency-systems-regular/1x/shopping-cart.png" alt="cart"></a>
              </li>
              <li id="new1" class="nav-item">
                <a class="nav-link" href="./furnitre.html">Furnitre</a>
              </li>
              <li id="new2" class="nav-item" >
                <a class="nav-link" href="./decor.html">Decor</a>
              </li>
              <li id="new3" class="nav-item" >
                <a class="nav-link" href="./outdoor.html">Outdoor</a>
              </li>
              
              
            </ul>
          
          </div>
        </div>
      </nav>
     
     <div class="bar">
      <a href="./furnitre.html">Furnitre</a>
      <a href="./outdoor.html">Outdoor</a>
      <a href="./rugs.html">Rugs</a>
      <a href="#">Decor</a>
      <a href="#">Bedding</a>
      <a href="#">Home Improvement</a>
      <a href="#">Kitchen</a>
      <a href="#">Lighting</a>
      <a href="#">Kids & Baby</a>
      <a href="#">Bath</a>
      <a href="#">More</a>
      <a href="#">Ideas</a>
      <a href="#">Sales & Deals</a>
     </div>
     <br>
     <div id="spinner">
      <div class="spinner-inner"></div>
    </div>
     <div class="container text-center">
      <div class="row">
        <div class="col-lg-4">
          <h2 style="overflow: hidden; ">Price</h2>
          <div id="secondContainer">
             <span> <input type="checkbox" value="50000" name="price" id="lower"> <label for="lower">Under than 50K</label></span>
             
              <br>
             <span><input type="checkbox" value="70000" name="price"  id="lower1">
              <label for="lower">Under than 70K</label></span> 
              <br>
              <span><input type="checkbox" value="80000" name="price"  id="lower2">
                <label for="lower">Under than 80K</label></span>
              <br>
            <span> <input type="checkbox" value="100000" name="price" id="lower3">
              <label for="lower">Under than 1L</label></span> 
              <br>
            <span> <input type="checkbox" value="100000" name="price"  id="high">
              <label for="lower"> 1L or More</label></span> 
              <br>
              <br>
              <h2 style="overflow: hidden; ">Customer Ratings</h2>
              <span> <input type="radio" name="rating" id="low"> <label for="low">Under 2</label></span>
             
              <br>
             <span><input type="radio" name="rating1" id="low1">
              <label for="low">Under 4</label></span> 
              <br>
              <span><input type="radio" name="rating2" id="higher">
                <label for="high">More than 4</label></span>
              <br>
          

          </div>
        </div>
        <div class="col-lg-8">
          <div id="container"> </div>
        </div>
        
      </div>
    </div>
    
    <footer>
      <div class="container text-center">
        <div class="row">
          <div class="col-md">
            <h4>My Account</h4>
              <ul>
                <li>Orders</li>
                <li>Email</li>
                <li>Account</li>
                
              </ul>
          </div>
          <div class="col-md">
            <h4>Let us help</h4>
            <ul>
              <li>Contact</li>
              <li>Customer Care</li>
              <li>Shoppping</li>
              <li>Return Policy</li>
              <li>Accessibility</li>
              
            </ul>
          </div>
          <div class="col-md">
            <h4>Let us help</h4>
            <ul>
              <li>Contact</li>
              <li>Customer Care</li>
              <li>Shoppping</li>
              <li>Return Policy</li>
              <li>Accessibility</li>
              
            </ul>
          </div>
          <div class="col-md">
            <h4>Let us help</h4>
            <ul>
              <li>Contact</li>
              <li>Customer Care</li>
              <li>Shoppping</li>
              <li>Return Policy</li>
              <li>Accessibility</li>
              
            </ul>
          </div>
        </div>
      </div>
     </footer>
  
  
    <section>
      &copy; Copyright 2023, FurnStock.comÂ®, Inc.
    </section>

      
    
    

     
 
</body>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/js/bootstrap.bundle.min.js" integrity="sha384-qKXV1j0HvMUeCBQ+QVp7JcfGl760yU08IQ+GpUo5hlbpg51QRiuqHAJz8+BrxE/N" crossorigin="anonymous"></script>
<script>
    let container = document.getElementById("container")
    const spinner = document.getElementById("spinner")
    

    const checkboxes = document.querySelectorAll('input[type=checkbox]');

    function getFilters() {
  let filters = {};
  checkboxes.forEach((checkbox) => {
    if (checkbox.checked) {
      const value = checkbox.value;
      if (!isNaN(value)) {
        filters[checkbox.name] = Number(value);
      } else {
        filters[checkbox.name] = value;
      }
    }
  });
  return filters;
}

function getData() {
  spinner.style.display = "block"
  const filters = getFilters();
  const queryString = Object.entries(filters).map(([key, value]) => `${key}=${value}`).join('&');
  fetch(`http://localhost:5050/product/?${queryString}`)
    .then((response) => response.json())
    .then((data) => {
      spinner.style.display = "none"
      console.log(data);
      // Code to display products goes here
      display(data)
    })
    .catch((error) => {
      console.error(error);
    });
}

checkboxes.forEach((checkbox) => {
  checkbox.removeEventListener("change", getData); // Remove any existing event listeners
  checkbox.addEventListener("change", getData);
});

    function display(data) {
      container.innerHTML = ""
      data.forEach(element => {
          const card = document.createElement("div")
          card.setAttribute("class","card")

          const image = document.createElement("img")
          image.setAttribute("src",element.link)
          image.style.height = "40%"

          const cost  = document.createElement("p")
          cost.innerText = `INR ${element.cost}/-`
          cost.style.color = "red"
          cost.style.fontSize="1.2rem"

          const rating =  document.createElement("p")
          rating.innerText =`Rating: ${element.rating}`

          const desc = document.createElement("p")
          desc.innerText = element.desciption
          desc.style.color = "#660033"

          const add = document.createElement("button")
          add.innerText = "Cart"
          add.style.backgroundColor = "green"
          add.style.width = "50%"
          add.style.margin = "auto"
          add.style.height = "6%"
          add.style.border = "transparent"
          add.style.color = "white"
          add.addEventListener("click",()=>{
            pushItem(element.link,element.cost,element.rating,element.desciption)
          })

          card.append(image,cost,rating,desc,add)
          container.append(card)



      });
      
    }
    function pushItem(link,cost,rating,desciption) {
      console.log(cost)
      fetch("http://localhost:5050/furnitre/add",{
        method:"POST",
        headers:{
          "Content-Type":"application/json",
          "Authorization":`Bearer ${localStorage.getItem("token")}`
        },
        body:JSON.stringify({
          link:link,
          cost:cost,
          rating:rating,
          desciption:desciption,
          quantity:1
        })
      }
     )
     .then((res)=>res.json())
     .then(res=>{
      console.log(res)
      alert("Item Added Successfully")
     })
     .catch(err=>console.log(err))
      
    }
    getData()
</script>
</html>